<script type="text/javascript">
    RED.nodes.registerType('schema-bridge', {
        category: 'database',
        color: '#D4A574',
        defaults: {
            name: { value: "" },
            sourceConnection: { value: "", type: "Schema Bridge Connection" },
            targetConnection: { value: "", type: "Schema Bridge Connection" },
            sourceTable: { value: "" },
            targetTable: { value: "" },
            generateSql: { value: true },
            createTable: { value: false },
            customSchema: { value: "[]" },
            operationMode: { value: "connection" }, // "connection" or "generation"
            targetDbType: { value: "postgres" } // Áî®Êñº generation Ê®°Âºè
        },
        inputs: 1,
        outputs: 1,
        icon: "bridge.png",
        label: function() {
            return this.name || "Schema Bridge";
        },
        labelStyle: function() {
            return this.name ? "node_label_italic" : "";
        },
        oneditprepare: function() {
            const node = this;
            
            // Ê≥®ÂÖ•Á¥ÖÈªë‰∏ªÈ°åÁöÑÈ°çÂ§ñÊ®£Âºè
            if (!$('#schema-bridge-dark-theme').length) {
                $('head').append(`
                    <style id="schema-bridge-dark-theme">
                        .mode-option:hover {
                            transform: translateY(-2px);
                            border-color: #dc3545 !important;
                            background-color: #3a1a1a !important;
                            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.2) !important;
                        }
                        .mode-option {
                            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                        }
                        .mode-option .fa {
                            transition: all 0.3s ease;
                        }
                        .mode-option:hover .fa {
                            transform: scale(1.1);
                            text-shadow: 0 0 10px rgba(220, 53, 69, 0.6);
                        }
                        
                        /* Nullable master checkbox Ê®£Âºè */
                        #nullable-master-checkbox {
                            appearance: none;
                            width: 16px;
                            height: 16px;
                            border: 2px solid #666;
                            border-radius: 3px;
                            background: #2a2a2a;
                            position: relative;
                            transition: all 0.3s ease;
                        }
                        
                        #nullable-master-checkbox:checked {
                            background: #dc3545;
                            border-color: #dc3545;
                        }
                        
                        #nullable-master-checkbox:checked::after {
                            content: '‚úì';
                            position: absolute;
                            top: -2px;
                            left: 2px;
                            color: white;
                            font-size: 12px;
                            font-weight: bold;
                        }
                        
                        #nullable-master-checkbox:indeterminate {
                            background: linear-gradient(135deg, #dc3545 0%, #dc3545 50%, #666 50%, #666 100%);
                            border-color: #dc3545;
                        }
                        
                        #nullable-master-checkbox:indeterminate::after {
                            content: '‚óó';
                            position: absolute;
                            top: -2px;
                            left: 2px;
                            color: white;
                            font-size: 12px;
                            font-weight: bold;
                        }
                        
                        #nullable-master-checkbox:hover {
                            border-color: #dc3545;
                            box-shadow: 0 0 8px rgba(220, 53, 69, 0.4);
                            transform: scale(1.05);
                        }
                        
                        #nullable-master-checkbox + label {
                            transition: color 0.3s ease;
                        }
                        
                        #nullable-master-checkbox + label:hover {
                            color: #dc3545 !important;
                        }
                        
                        /* Nullable master control container hover effect */
                        .nullable-master-control {
                            transition: all 0.3s ease;
                        }
                        
                        .nullable-master-control:hover {
                            background: linear-gradient(135deg, #4a4a4a 0%, #3a3a3a 100%) !important;
                            border-color: #dc3545 !important;
                            box-shadow: 0 2px 8px rgba(220, 53, 69, 0.2);
                        }
                        
                        /* ÊåâÈàïhoverÊïàÊûú */
                        #add-column-btn:hover {
                            background: linear-gradient(135deg, #5a7851 0%, #6a8861 100%) !important;
                            transform: translateY(-2px);
                            box-shadow: 0 4px 12px rgba(74, 103, 65, 0.4) !important;
                        }
                        
                        #preview-sql-btn:hover {
                            background: linear-gradient(135deg, #5a6f7a 0%, #6a7f8a 100%) !important;
                            transform: translateY(-2px);
                            box-shadow: 0 4px 12px rgba(74, 95, 106, 0.4) !important;
                        }
                        
                        #add-column-btn:active, #preview-sql-btn:active {
                            transform: translateY(0px);
                        }
                        
                        /* ÊªæÂãïÂÆπÂô®Ê®£ÂºèÁæéÂåñ */
                        .schema-table-container {
                            overflow-y: auto;
                            border: 1px solid #555;
                            border-radius: 6px;
                            background-color: #2a2a2a;
                            min-height: 0;
                        }
                        
                        .schema-table-container::-webkit-scrollbar {
                            width: 12px;
                        }
                        
                        .schema-table-container::-webkit-scrollbar-track {
                            background: #1e1e1e;
                            border-radius: 6px;
                        }
                        
                        .schema-table-container::-webkit-scrollbar-thumb {
                            background: linear-gradient(135deg, #555 0%, #777 100%);
                            border-radius: 6px;
                            border: 2px solid #1e1e1e;
                        }
                        
                        .schema-table-container::-webkit-scrollbar-thumb:hover {
                            background: linear-gradient(135deg, #666 0%, #888 100%);
                        }
                        
                        /* Ê®ôÁ±§È†ÅÊªæÂãïÊ¢ùÊ®£Âºè */
                        #schema-bridge-tab-basic::-webkit-scrollbar {
                            width: 8px;
                        }
                        
                        #schema-bridge-tab-basic::-webkit-scrollbar-track {
                            background: #1e1e1e;
                            border-radius: 4px;
                        }
                        
                        #schema-bridge-tab-basic::-webkit-scrollbar-thumb {
                            background: linear-gradient(135deg, #555 0%, #777 100%);
                            border-radius: 4px;
                        }
                        
                        #schema-bridge-tab-basic::-webkit-scrollbar-thumb:hover {
                            background: linear-gradient(135deg, #666 0%, #888 100%);
                        }
                    </style>
                `);
            }
            
            // ÂàùÂßãÂåñÊ®ôÁ±§È†Å
            const tabs = RED.tabs.create({
                id: "node-schema-bridge-tabs",
                onchange: function(tab) {
                    $("#node-schema-bridge-tabs-content").children().hide();
                    $("#" + tab.id).show();
                }
            });
            
            // Ê®°ÂºèÂàáÊèõÈÇèËºØ
            function updateModeDisplay() {
                const mode = $('input[name="operationMode"]:checked').val();
                
                if (mode === 'connection') {
                    // Database Connection Mode
                    $('#target-connection-section').show();
                    $('#target-dbtype-section').hide();
                    $('#create-table-option').show();
                    $('#node-input-generateSql').prop('disabled', false);
                    $('#node-input-createTable').prop('disabled', false);
                    $('#mode-info-text').text('üîó ÂÆåÊï¥ÈÄ£Êé•Ê®°ÂºèÔºöÂèØ‰ª•Áî¢Áîü SQL Êåá‰ª§‰∏¶Âú®ÁõÆÊ®ôË≥áÊñôÂ∫´Âª∫Á´ãË°®Ê†º');
                    
                    // Êõ¥Êñ∞Ê®°ÂºèÊåâÈàïÊ®£Âºè - Á¥ÖÈªë‰∏ªÈ°å
                    $('#connection-mode-label').css({
                        'border-color': '#dc3545',
                        'background-color': '#4a1a1a',
                        'box-shadow': '0 0 10px rgba(220, 53, 69, 0.3)'
                    });
                    $('#generation-mode-label').css({
                        'border-color': '#444',
                        'background-color': '#333',
                        'box-shadow': 'none'
                    });
                } else {
                    // SQL Generation Mode
                    $('#target-connection-section').hide();
                    $('#target-dbtype-section').show();
                    $('#create-table-option').hide();
                    $('#node-input-generateSql').prop('checked', true).prop('disabled', true);
                    $('#node-input-createTable').prop('checked', false).prop('disabled', true);
                    $('#mode-info-text').text('üìù SQL ÁîüÊàêÊ®°ÂºèÔºöÂÉÖÁî¢Áîü SQL Êåá‰ª§Ôºå‰∏çÈúÄË¶ÅÈÄ£Êé•ÁõÆÊ®ôË≥áÊñôÂ∫´');
                    
                    // Êõ¥Êñ∞Ê®°ÂºèÊåâÈàïÊ®£Âºè - Á¥ÖÈªë‰∏ªÈ°å
                    $('#connection-mode-label').css({
                        'border-color': '#444',
                        'background-color': '#333',
                        'box-shadow': 'none'
                    });
                    $('#generation-mode-label').css({
                        'border-color': '#dc3545',
                        'background-color': '#4a1a1a',
                        'box-shadow': '0 0 10px rgba(220, 53, 69, 0.3)'
                    });
                }
            }
            
            // ÂàùÂßãÂåñÊ®°ÂºèË®≠ÂÆö
            const initialMode = node.operationMode || 'connection';
            $(`#node-input-operationMode-${initialMode}`).prop('checked', true);
            updateModeDisplay();
            
            // Ê®°ÂºèÂàáÊèõ‰∫ã‰ª∂Áõ£ËÅΩ
            $('input[name="operationMode"]').change(function() {
                updateModeDisplay();
                
                // ÈáçÊñ∞ËºâÂÖ•ÊîØÊè¥ÁöÑÈ°ûÂûãÈÅ∏È†Ö
                setTimeout(function() {
                    const operationMode = $('input[name="operationMode"]:checked').val();
                    let targetDbType;
                    
                    if (operationMode === 'connection') {
                        const targetConnection = $('#node-input-targetConnection').val();
                        const targetConnectionNode = RED.nodes.node(targetConnection);
                        targetDbType = targetConnectionNode ? targetConnectionNode.dbType : null;
                    } else {
                        targetDbType = $('#node-input-targetDbType').val();
                    }
                    
                    if (targetDbType) {
                        updateTargetTypeOptions(targetDbType);
                    }
                }, 100);
            });
            
            // ÁõÆÊ®ôÈÄ£Êé•ÊàñË≥áÊñôÂ∫´È°ûÂûãËÆäÊõ¥‰∫ã‰ª∂Áõ£ËÅΩ
            $('#node-input-targetConnection, #node-input-targetDbType').change(function() {
                const operationMode = $('input[name="operationMode"]:checked').val();
                let targetDbType;
                
                if (operationMode === 'connection') {
                    const targetConnection = $('#node-input-targetConnection').val();
                    const targetConnectionNode = RED.nodes.node(targetConnection);
                    targetDbType = targetConnectionNode ? targetConnectionNode.dbType : null;
                } else {
                    targetDbType = $('#node-input-targetDbType').val();
                }
                
                if (targetDbType) {
                    updateTargetTypeOptions(targetDbType);
                }
            });
            
            // Ê®°ÂºèÊåâÈàïÈªûÊìä‰∫ã‰ª∂ÔºàÁæéÂåñÁöÑÈªûÊìäÈ´îÈ©óÔºâ
            $('.mode-option').click(function() {
                const radioInput = $(this).find('input[type="radio"]');
                radioInput.prop('checked', true);
                updateModeDisplay();
            });
            
            tabs.addTab({
                id: "schema-bridge-tab-basic",
                label: "Basic"
            });
            
            tabs.addTab({
                id: "schema-bridge-tab-schema",
                label: "Schema Editor"
            });
            
            tabs.addTab({
                id: "schema-bridge-tab-sql",
                label: "SQL Output"
            });
            
            // ËºâÂÖ• schemaÔºàÂæûËº∏ÂÖ•ÁöÑË°®Ê†ºÂêçÁ®±Ôºâ
            function loadSchemaFromInput() {
                const sourceConnection = $('#node-input-sourceConnection').val();
                const sourceTable = $('#node-input-sourceTable').val().trim();
                
                if (!sourceConnection) {
                    RED.notify('Please select a source connection first', 'warning');
                    return;
                }
                
                if (!sourceTable) {
                    RED.notify('Please enter a table name', 'warning');
                    return;
                }
                
                // È°ØÁ§∫ËºâÂÖ•ÁãÄÊÖã
                const loadButton = $('#load-schema-btn');
                const originalText = loadButton.html();
                loadButton.html('<i class="fa fa-spinner fa-spin"></i> Loading...').prop('disabled', true);
                
                // Á¢∫‰øùÊåâÈàïÁãÄÊÖãÁ∏ΩÊòØËÉΩÂ§†ÊÅ¢Âæ©
                const restoreButton = () => {
                    loadButton.html(originalText).prop('disabled', false);
                };
                
                loadSourceSchema()
                    .then(() => {
                        restoreButton();
                    })
                    .catch((error) => {
                        restoreButton();
                        console.error('Load schema error:', error);
                    });
            }
            
            // ËºâÂÖ• schema
            function loadSourceSchema() {
                const sourceConnection = $('#node-input-sourceConnection').val();
                const sourceTable = $('#node-input-sourceTable').val();
                
                if (!sourceConnection || !sourceTable) {
                    return Promise.reject(new Error('Missing connection or table name'));
                }
                
                return new Promise((resolve, reject) => {
                    $.ajax({
                        url: '/schema-bridge/connection-schema',
                        method: 'POST',
                        data: JSON.stringify({
                            connectionId: sourceConnection,
                            tableName: sourceTable
                        }),
                        contentType: 'application/json',
                        timeout: 30000 // 30ÁßíË∂ÖÊôÇ
                    })
                    .done(function(schema) {
                        try {
                            displaySchemaEditor(schema);
                            RED.notify('Schema loaded successfully!', 'success');
                            resolve(schema);
                        } catch (error) {
                            reject(error);
                        }
                    })
                    .fail(function(xhr, status, error) {
                        const errorMsg = xhr.responseJSON?.error || xhr.responseText || error || 'Unknown error';
                        RED.notify('Failed to load schema: ' + errorMsg, 'error');
                        reject(new Error(errorMsg));
                    });
                });
            }
            
            // È°ØÁ§∫ Schema Á∑®ËºØÂô®
            function displaySchemaEditor(schema) {
                const container = $('#schema-editor-container');
                container.empty();
                
                if (!schema || schema.length === 0) {
                    container.append('<p>No schema data available. Please select a source table first.</p>');
                    return;
                }
                
                const table = $(`
                    <table class="schema-table" style="width: 100%; border-collapse: collapse; background-color: #2a2a2a; color: #e0e0e0;">
                        <thead>
                            <tr style="background-color: #3a3a3a;">
                                <th style="border: 1px solid #555; padding: 8px; color: #f0f0f0;">Column Name</th>
                                <th style="border: 1px solid #555; padding: 8px; color: #f0f0f0;">Source Type</th>
                                <th style="border: 1px solid #555; padding: 8px; color: #f0f0f0;">Target Type</th>
                                <th style="border: 1px solid #555; padding: 8px; color: #f0f0f0; text-align: center;">
                                    <div style="display: flex; flex-direction: column; align-items: center; gap: 6px;">
                                        <span style="font-weight: bold; font-size: 13px;">Nullable</span>
                                        <div class="nullable-master-control" style="display: flex; align-items: center; gap: 6px; background: linear-gradient(135deg, #3a3a3a 0%, #2a2a2a 100%); padding: 6px 10px; border-radius: 8px; border: 1px solid #555; cursor: pointer;">
                                            <input type="checkbox" id="nullable-master-checkbox" title="Toggle all nullable columns" style="cursor: pointer;">
                                            <label for="nullable-master-checkbox" style="font-size: 11px; color: #e0e0e0; margin: 0; cursor: pointer; font-weight: 500; text-shadow: 0 1px 2px rgba(0,0,0,0.3); user-select: none;">All</label>
                                        </div>
                                    </div>
                                </th>
                                <th style="border: 1px solid #555; padding: 8px; color: #f0f0f0;">Default Value</th>
                                <th style="border: 1px solid #555; padding: 8px; color: #f0f0f0;">Actions</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                `);
                
                const tbody = table.find('tbody');
                
                // Áç≤ÂèñÁõÆÊ®ôË≥áÊñôÂ∫´È°ûÂûã
                const operationMode = $('input[name="operationMode"]:checked').val();
                let targetDbType;
                
                if (operationMode === 'connection') {
                    const targetConnection = $('#node-input-targetConnection').val();
                    const targetConnectionNode = RED.nodes.node(targetConnection);
                    targetDbType = targetConnectionNode ? targetConnectionNode.dbType : null;
                } else {
                    targetDbType = $('#node-input-targetDbType').val();
                }
                
                schema.forEach((column, index) => {
                    // ‰ΩøÁî®Êô∫ËÉΩËΩâÊèõË®àÁÆóÂª∫Ë≠∞ÁöÑÁõÆÊ®ôÈ°ûÂûã
                    let suggestedType = column.type; // È†êË®≠‰ΩøÁî®ÂéüÈ°ûÂûã
                    
                    if (targetDbType && column.sourceDbType) {
                        try {
                            // Âª∫Á´ãËá®ÊôÇÁöÑSchemaMapper‰æÜË®àÁÆóÂª∫Ë≠∞È°ûÂûã
                            $.ajax({
                                url: '/schema-bridge/convert-type',
                                method: 'POST',
                                data: JSON.stringify({
                                    sourceType: column.type,
                                    sourceDbType: column.sourceDbType,
                                    targetDbType: targetDbType,
                                    precision: column.length || column.precision,
                                    scale: column.scale
                                }),
                                contentType: 'application/json',
                                async: false // ÂêåÊ≠•Ë´ãÊ±Ç‰ª•Áç≤ÂæóÂª∫Ë≠∞È°ûÂûã
                            })
                            .done(function(result) {
                                suggestedType = result.targetType;
                            })
                            .fail(function(xhr) {
                                // Â¶ÇÊûúËΩâÊèõÂ§±ÊïóÔºå‰øùÊåÅÂéüÈ°ûÂûã
                                console.warn(`Failed to convert type ${column.type} for ${column.name}:`, xhr.responseText);
                            });
                        } catch (e) {
                            console.warn('Type conversion error:', e);
                        }
                    }
                    
                    const row = $(`
                        <tr data-index="${index}" style="background-color: #2a2a2a;">
                            <td style="border: 1px solid #555; padding: 8px;">
                                <input type="text" value="${column.name}" class="column-name" style="width: 100%; border: none; background-color: #3a3a3a; color: #e0e0e0; padding: 4px;">
                            </td>
                            <td style="border: 1px solid #555; padding: 8px; color: #b0b0b0;">${column.type}</td>
                            <td style="border: 1px solid #555; padding: 8px;">
                                <select class="target-type" style="width: 100%; border: none; background-color: #3a3a3a; color: #e0e0e0; padding: 4px;">
                                    ${getTargetTypeOptions(suggestedType, targetDbType)}
                                </select>
                            </td>
                            <td style="border: 1px solid #555; padding: 8px; text-align: center;">
                                <input type="checkbox" class="nullable" ${column.nullable ? 'checked' : ''} style="transform: scale(1.2);">
                            </td>
                            <td style="border: 1px solid #555; padding: 8px;">
                                <input type="text" value="${column.defaultValue || ''}" class="default-value" style="width: 100%; border: none; background-color: #3a3a3a; color: #e0e0e0; padding: 4px;">
                            </td>
                            <td style="border: 1px solid #555; padding: 8px;">
                                <button type="button" class="delete-column" style="background-color: #c44; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer;">Delete</button>
                            </td>
                        </tr>
                    `);
                    tbody.append(row);
                });
                
                // ÂãïÊÖãËºâÂÖ•ÁõÆÊ®ôË≥áÊñôÂ∫´ÊîØÊè¥ÁöÑÈ°ûÂûãÈÅ∏È†ÖÔºàÂª∂ÈÅ≤Âü∑Ë°åÔºåÁ¢∫‰øù‰∏çÊúÉË¶ÜËìãÂ∑≤Ë®≠ÁΩÆÁöÑÂª∫Ë≠∞È°ûÂûãÔºâ
                if (targetDbType) {
                    setTimeout(() => {
                        updateTargetTypeOptionsWithPreservation(targetDbType);
                    }, 100);
                }
                
                // ÂâµÂª∫Ë°®Ê†ºÊªæÂãïÂçÄÂüü
                const tableScrollArea = $('<div style="flex: 1; display: flex; flex-direction: column; min-height: 0;"></div>');
                const scrollContainer = $('<div class="schema-table-container" style="flex: 1;"></div>');
                scrollContainer.append(table);
                tableScrollArea.append(scrollContainer);
                
                container.append(tableScrollArea);
                
                // ‰∏ªÊéß nullable checkbox ‰∫ã‰ª∂ËôïÁêÜ
                $('#nullable-master-checkbox').change(function() {
                    const isChecked = $(this).prop('checked');
                    const nullableCheckboxes = container.find('.nullable');
                    
                    // Ë®≠ÂÆöÊâÄÊúâÁöÑ nullable checkbox
                    nullableCheckboxes.prop('checked', isChecked);
                    
                    // Ë¶ñË¶∫ÂèçÈ•ã
                    if (isChecked) {
                        RED.notify(`‚úÖ All columns set to nullable`, 'success');
                    } else {
                        RED.notify(`üö´ All columns set to NOT NULL`, 'success');
                    }
                });
                
                // ÈªûÊìäÊï¥ÂÄãÊéßÂà∂ÂÆπÂô®‰πüËÉΩËß∏Áôºcheckbox
                container.on('click', '.nullable-master-control', function(e) {
                    if (e.target.type !== 'checkbox' && e.target.tagName !== 'LABEL') {
                        const checkbox = $('#nullable-master-checkbox');
                        checkbox.prop('checked', !checkbox.prop('checked')).trigger('change');
                    }
                });
                
                // Áõ£ËÅΩÂÄãÂà• nullable checkbox ËÆäÂåñÔºåÊõ¥Êñ∞‰∏ªÊéßcheckboxÁãÄÊÖã
                container.on('change', '.nullable', function() {
                    updateMasterCheckboxState();
                });
                
                // Êõ¥Êñ∞‰∏ªÊéßcheckboxÁöÑÁãÄÊÖãÔºàÂÖ®ÈÅ∏„ÄÅÈÉ®ÂàÜÈÅ∏Âèñ„ÄÅÂÖ®‰∏çÈÅ∏Ôºâ
                function updateMasterCheckboxState() {
                    const nullableCheckboxes = container.find('.nullable');
                    const checkedCount = nullableCheckboxes.filter(':checked').length;
                    const totalCount = nullableCheckboxes.length;
                    
                    const masterCheckbox = $('#nullable-master-checkbox');
                    
                    if (checkedCount === 0) {
                        // ÂÖ®ÈÉ®Êú™ÈÅ∏Âèñ
                        masterCheckbox.prop('checked', false);
                        masterCheckbox.prop('indeterminate', false);
                        masterCheckbox.attr('title', `Click to set all ${totalCount} columns to nullable`);
                    } else if (checkedCount === totalCount) {
                        // ÂÖ®ÈÉ®ÈÅ∏Âèñ
                        masterCheckbox.prop('checked', true);
                        masterCheckbox.prop('indeterminate', false);
                        masterCheckbox.attr('title', `All ${totalCount} columns are nullable. Click to set all to NOT NULL`);
                    } else {
                        // ÈÉ®ÂàÜÈÅ∏Âèñ
                        masterCheckbox.prop('checked', false);
                        masterCheckbox.prop('indeterminate', true);
                        masterCheckbox.attr('title', `${checkedCount} of ${totalCount} columns are nullable. Click to set all to nullable`);
                    }
                }
                
                // ÂàùÂßãÂåñ‰∏ªÊéßcheckboxÁãÄÊÖã
                setTimeout(updateMasterCheckboxState, 100);
                
                // ÂâµÂª∫Âõ∫ÂÆöÊåâÈàïÂçÄÂüü
                const buttonContainer = $(`
                    <div style="flex-shrink: 0; display: flex; gap: 12px; justify-content: flex-start; align-items: center; padding: 15px; background: linear-gradient(135deg, #1e1e1e 0%, #2a2a2a 100%); border-radius: 8px; border: 1px solid #555; margin-top: 15px;">
                        <button type="button" id="add-column-btn" style="
                            background: linear-gradient(135deg, #4a6741 0%, #5a7851 100%); 
                            color: white; 
                            border: none; 
                            padding: 10px 16px; 
                            border-radius: 6px; 
                            cursor: pointer; 
                            font-weight: 500;
                            transition: all 0.3s ease;
                            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
                            display: flex;
                            align-items: center;
                            gap: 6px;
                        ">
                            <i class="fa fa-plus"></i> Add Column
                        </button>
                        <button type="button" id="preview-sql-btn" style="
                            background: linear-gradient(135deg, #4a5f6a 0%, #5a6f7a 100%); 
                            color: white; 
                            border: none; 
                            padding: 10px 16px; 
                            border-radius: 6px; 
                            cursor: pointer; 
                            font-weight: 500;
                            transition: all 0.3s ease;
                            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
                            display: flex;
                            align-items: center;
                            gap: 6px;
                        ">
                            <i class="fa fa-eye"></i> Preview SQL
                        </button>
                        <div style="flex: 1;"></div>
                        <span style="color: #bbb; font-size: 12px; font-style: italic;">
                            <i class="fa fa-info-circle"></i> Schema contains ${schema.length} column${schema.length !== 1 ? 's' : ''}
                        </span>
                    </div>
                `);
                
                container.append(buttonContainer);
                
                // Êñ∞Â¢ûÊ¨Ñ‰ΩçÊåâÈàï‰∫ã‰ª∂
                buttonContainer.find('#add-column-btn').click(function() {
                    // Áç≤ÂèñÁï∂ÂâçÁõÆÊ®ôË≥áÊñôÂ∫´È°ûÂûãÊ±∫ÂÆöÈ†êË®≠È°ûÂûã
                    let defaultType = 'VARCHAR(255)';
                    if (targetDbType) {
                        if (targetDbType === 'oracle') {
                            defaultType = 'VARCHAR2(255)';
                        } else if (targetDbType === 'mssql') {
                            defaultType = 'NVARCHAR(255)';
                        }
                    }
                    
                    const newRow = $(`
                        <tr data-index="${schema.length}" style="background-color: #2a2a2a;">
                            <td style="border: 1px solid #555; padding: 8px;">
                                <input type="text" value="new_column" class="column-name" style="width: 100%; border: none; background-color: #3a3a3a; color: #e0e0e0; padding: 4px;">
                            </td>
                            <td style="border: 1px solid #555; padding: 8px; color: #b0b0b0;">${defaultType}</td>
                            <td style="border: 1px solid #555; padding: 8px;">
                                <select class="target-type" style="width: 100%; border: none; background-color: #3a3a3a; color: #e0e0e0; padding: 4px;">
                                    ${getTargetTypeOptions(defaultType, targetDbType)}
                                </select>
                            </td>
                            <td style="border: 1px solid #555; padding: 8px; text-align: center;">
                                <input type="checkbox" class="nullable" checked style="transform: scale(1.2);">
                            </td>
                            <td style="border: 1px solid #555; padding: 8px;">
                                <input type="text" value="" class="default-value" style="width: 100%; border: none; background-color: #3a3a3a; color: #e0e0e0; padding: 4px;">
                            </td>
                            <td style="border: 1px solid #555; padding: 8px;">
                                <button type="button" class="delete-column" style="background-color: #c44; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer;">Delete</button>
                            </td>
                        </tr>
                    `);
                    tbody.append(newRow);
                    
                    // Â¶ÇÊûúÊúâÁõÆÊ®ôË≥áÊñôÂ∫´È°ûÂûãÔºåËºâÂÖ•ÊîØÊè¥ÁöÑÈ°ûÂûãÈÅ∏È†Ö
                    if (targetDbType) {
                        const newSelect = newRow.find('.target-type');
                        $.ajax({
                            url: `/schema-bridge/supported-types/${targetDbType}`,
                            method: 'GET'
                        })
                        .done(function(supportedTypes) {
                            const options = supportedTypes.map(type => 
                                `<option value="${type}" ${type === defaultType ? 'selected' : ''}>${type}</option>`
                            ).join('');
                            newSelect.html(options);
                        });
                    }
                    
                    // Êõ¥Êñ∞‰∏ªÊéßcheckboxÁãÄÊÖã
                    setTimeout(updateMasterCheckboxState, 50);
                    
                    // Êõ¥Êñ∞ÂàóÊï∏Áµ±Ë®à
                    const currentCount = tbody.find('tr').length;
                    buttonContainer.find('span').html(`<i class="fa fa-info-circle"></i> Schema contains ${currentCount} column${currentCount !== 1 ? 's' : ''}`);
                    
                    // Ëá™ÂãïÊªæÂãïÂà∞Â∫ïÈÉ®È°ØÁ§∫Êñ∞Â¢ûÁöÑË°å
                    scrollContainer.animate({
                        scrollTop: scrollContainer[0].scrollHeight
                    }, 300);
                });
                
                // È†êË¶Ω SQL ÊåâÈàï‰∫ã‰ª∂
                buttonContainer.find('#preview-sql-btn').click(generateSqlPreview);
                
                // Âà™Èô§Ê¨Ñ‰Ωç‰∫ã‰ª∂
                container.on('click', '.delete-column', function() {
                    $(this).closest('tr').remove();
                    
                    // Êõ¥Êñ∞‰∏ªÊéßcheckboxÁãÄÊÖã
                    setTimeout(updateMasterCheckboxState, 50);
                    
                    // Êõ¥Êñ∞ÂàóÊï∏Áµ±Ë®à
                    const currentCount = tbody.find('tr').length;
                    buttonContainer.find('span').html(`<i class="fa fa-info-circle"></i> Schema contains ${currentCount} column${currentCount !== 1 ? 's' : ''}`);
                });
            }
            
            // ÂèñÂæóÁõÆÊ®ôÈ°ûÂûãÈÅ∏È†Ö
            function getTargetTypeOptions(selectedType, targetDbType = null) {
                // Â¶ÇÊûúÊ≤íÊúâÊåáÂÆöÁõÆÊ®ôË≥áÊñôÂ∫´È°ûÂûãÔºå‰ΩøÁî®ÈÄöÁî®È°ûÂûã
                if (!targetDbType) {
                    const commonTypes = [
                        'VARCHAR(255)', 'VARCHAR(100)', 'VARCHAR(50)',
                        'TEXT', 'NVARCHAR(255)', 'CHAR(10)',
                        'INT', 'INTEGER', 'BIGINT', 'SMALLINT',
                        'DECIMAL(10,2)', 'NUMERIC(10,2)', 'FLOAT', 'DOUBLE',
                        'DATE', 'TIME', 'DATETIME', 'TIMESTAMP',
                        'BOOLEAN', 'BIT', 'BLOB', 'CLOB',
                        'SERIAL', 'SERIAL PRIMARY KEY'
                    ];
                    
                    return commonTypes.map(type => 
                        `<option value="${type}" ${type === selectedType ? 'selected' : ''}>${type}</option>`
                    ).join('');
                }
                
                // Â¶ÇÊûúÊúâÁõÆÊ®ôË≥áÊñôÂ∫´È°ûÂûãÔºåËøîÂõûËºâÂÖ•‰∏≠ÁöÑÈÅ∏È†ÖÔºåÁ®çÂæåÊúÉË¢´Êõ¥Êñ∞
                return `<option value="${selectedType}" selected>${selectedType}</option>`;
            }
            
            // ÂãïÊÖãËºâÂÖ•‰∏¶Êõ¥Êñ∞ÁõÆÊ®ôÈ°ûÂûãÈÅ∏È†Ö
            function updateTargetTypeOptions(targetDbType) {
                if (!targetDbType) return;
                
                $.ajax({
                    url: `/schema-bridge/supported-types/${targetDbType}`,
                    method: 'GET'
                })
                .done(function(supportedTypes) {
                    // Êõ¥Êñ∞ÊâÄÊúâÁöÑÁõÆÊ®ôÈ°ûÂûãÈÅ∏ÊìáÂô®
                    $('#schema-editor-container .target-type').each(function() {
                        const currentValue = $(this).val();
                        const options = supportedTypes.map(type => 
                            `<option value="${type}" ${type === currentValue ? 'selected' : ''}>${type}</option>`
                        ).join('');
                        $(this).html(options);
                    });
                })
                .fail(function(xhr) {
                    console.warn('Failed to load supported types:', xhr.responseText);
                });
            }
            
            // ÂãïÊÖãËºâÂÖ•‰∏¶Êõ¥Êñ∞ÁõÆÊ®ôÈ°ûÂûãÈÅ∏È†ÖÔºà‰øùÁïôÂ∑≤Ë®≠ÁΩÆÁöÑÊô∫ËÉΩÂª∫Ë≠∞ÂÄºÔºâ
            function updateTargetTypeOptionsWithPreservation(targetDbType) {
                if (!targetDbType) return;
                
                $.ajax({
                    url: `/schema-bridge/supported-types/${targetDbType}`,
                    method: 'GET'
                })
                .done(function(supportedTypes) {
                    // Êõ¥Êñ∞ÊâÄÊúâÁöÑÁõÆÊ®ôÈ°ûÂûãÈÅ∏ÊìáÂô®Ôºå‰ΩÜ‰øùÁïôÁï∂ÂâçÂ∑≤Á∂ìÊ≠£Á¢∫Ë®≠ÁΩÆÁöÑÂÄº
                    $('#schema-editor-container .target-type').each(function() {
                        const currentValue = $(this).val();
                        const $select = $(this);
                        
                        // Â¶ÇÊûúÁï∂ÂâçÂÄºÂú®ÊîØÊè¥ÁöÑÈ°ûÂûã‰∏≠ÔºåÊàñËÄÖÊòØÊô∫ËÉΩËΩâÊèõÁöÑÁµêÊûúÔºåÂâá‰øùÁïôÂÆÉ
                        let options = '';
                        
                        // È¶ñÂÖàÂä†ÂÖ•Áï∂ÂâçÂÄºÔºàÂ¶ÇÊûúÂ≠òÂú®‰∏î‰∏çÁÇ∫Á©∫Ôºâ
                        if (currentValue && currentValue.trim()) {
                            options += `<option value="${currentValue}" selected>${currentValue}</option>`;
                        }
                        
                        // ÁÑ∂ÂæåÂä†ÂÖ•ÂÖ∂‰ªñÊîØÊè¥ÁöÑÈ°ûÂûã
                        supportedTypes.forEach(type => {
                            if (type !== currentValue) {
                                options += `<option value="${type}">${type}</option>`;
                            }
                        });
                        
                        $select.html(options);
                    });
                })
                .fail(function(xhr) {
                    console.warn('Failed to load supported types:', xhr.responseText);
                });
            }
            
            // ÁîüÊàê SQL È†êË¶Ω
            function generateSqlPreview() {
                const targetTable = $('#node-input-targetTable').val() || 'target_table';
                const operationMode = $('input[name="operationMode"]:checked').val();
                
                let targetDbType;
                
                if (operationMode === 'connection') {
                    // Database Connection Mode
                    const targetConnection = $('#node-input-targetConnection').val();
                    if (!targetConnection) {
                        RED.notify('Please select a target connection first', 'warning');
                        return;
                    }
                    
                    const targetConnectionNode = RED.nodes.node(targetConnection);
                    targetDbType = targetConnectionNode ? targetConnectionNode.dbType : 'postgres';
                } else {
                    // SQL Generation Mode
                    targetDbType = $('#node-input-targetDbType').val();
                }
                
                const schema = collectSchemaData();
                
                if (schema.length === 0) {
                    RED.notify('No schema data available. Please load schema first.', 'warning');
                    return;
                }
                
                const sql = generateCreateTableSQL(targetDbType, targetTable, schema);
                $('#sql-output').val(sql);
                
                // Âú® SQL Ëº∏Âá∫ÂâçÂä†ÂÖ•Ë®ªËß£Ë™™Êòé
                const modeInfo = operationMode === 'connection' ? 
                    `-- Generated in Database Connection Mode for ${targetDbType}\n-- This SQL can be executed directly on the target database\n\n` :
                    `-- Generated in SQL Generation Mode for ${targetDbType}\n-- Target database connection not required\n\n`;
                
                $('#sql-output').val(modeInfo + sql);
                
                // ÂàáÊèõÂà∞ SQL Ê®ôÁ±§
                tabs.activateTab("schema-bridge-tab-sql");
            }
            
            // Êî∂ÈõÜ schema Ë≥áÊñô
            function collectSchemaData() {
                const schema = [];
                $('#schema-editor-container tbody tr').each(function() {
                    const row = $(this);
                    if (row.find('.column-name').val()) {
                        schema.push({
                            name: row.find('.column-name').val(),
                            type: row.find('.target-type').val(),
                            nullable: row.find('.nullable').prop('checked'),
                            defaultValue: row.find('.default-value').val()
                        });
                    }
                });
                return schema;
            }
            
            // ÁîüÊàêÂª∫Ë°® SQL
            function generateCreateTableSQL(dbType, tableName, schema) {
                let sql = `CREATE TABLE ${tableName} (\n`;
                
                const columnDefs = schema.map(column => {
                    let def = `    ${column.name} ${column.type}`;
                    if (!column.nullable) def += ' NOT NULL';
                    if (column.defaultValue) {
                        // ËôïÁêÜ‰∏çÂêåÈ°ûÂûãÁöÑÈ†êË®≠ÂÄº
                        if (typeof column.defaultValue === 'string' && 
                            !column.defaultValue.startsWith('(') && 
                            !column.defaultValue.match(/^[0-9]+$/)) {
                            def += ` DEFAULT '${column.defaultValue}'`;
                        } else {
                            def += ` DEFAULT ${column.defaultValue}`;
                        }
                    }
                    return def;
                });
                
                sql += columnDefs.join(',\n');
                sql += '\n);';
                
                return sql;
            }
            
            // ‰∫ã‰ª∂Áõ£ËÅΩ
            $('#load-schema-btn').click(function() {
                loadSchemaFromInput();
            });
            
            // ÊîØÊè¥ Enter ÈçµËºâÂÖ• schema
            $('#node-input-sourceTable').keypress(function(e) {
                if (e.which === 13) { // Enter key
                    loadSchemaFromInput();
                }
            });
            
            // ÂàùÂßãÂåñ - ‰∏çÂÜçËá™ÂãïËºâÂÖ•Ë°®Ê†ºÂàóË°®
            
            // ËºâÂÖ•Ëá™Ë®Ç schema
            if (node.customSchema && node.customSchema !== '[]') {
                try {
                    const schema = JSON.parse(node.customSchema);
                    setTimeout(() => displaySchemaEditor(schema), 100);
                } catch (e) {
                    console.error('Failed to parse custom schema:', e);
                }
            }
        },
        
        oneditcancel: function() {
            // Ê∏ÖÁêÜÊ≥®ÂÖ•ÁöÑÊ®£Âºè
            $('#schema-bridge-dark-theme').remove();
        },
        
        oneditsave: function() {
            // Ê∏ÖÁêÜÊ≥®ÂÖ•ÁöÑÊ®£Âºè
            $('#schema-bridge-dark-theme').remove();
            
            // ÂÑ≤Â≠òÊìç‰ΩúÊ®°Âºè
            this.operationMode = $('input[name="operationMode"]:checked').val();
            
            // ÂÑ≤Â≠òËá™Ë®Ç schema
            const schema = [];
            $('#schema-editor-container tbody tr').each(function() {
                const row = $(this);
                if (row.find('.column-name').val()) {
                    schema.push({
                        name: row.find('.column-name').val(),
                        type: row.find('.target-type').val(),
                        nullable: row.find('.nullable').prop('checked'),
                        defaultValue: row.find('.default-value').val()
                    });
                }
            });
            this.customSchema = JSON.stringify(schema);
            
            // ÈÖçÁΩÆÂÆåÊàêÂæåËß∏ÁôºÈÄ£Á∑öÁãÄÊÖãÊ™¢Êü•
            const nodeId = this.id;
            if (nodeId) {
                setTimeout(() => {
                    $.ajax({
                        url: '/schema-bridge/check-connections',
                        method: 'POST',
                        data: JSON.stringify({ nodeId: nodeId }),
                        contentType: 'application/json'
                    }).done(function(result) {
                        console.log('Connection status checked for node:', nodeId);
                    }).fail(function(xhr) {
                        console.warn('Failed to check connection status:', xhr.responseText);
                    });
                }, 1000); // Á≠âÂæÖÁØÄÈªûÂÑ≤Â≠òÂÆåÊàêÂæåÂÜçÊ™¢Êü•
            }
        }
    });
</script>

<script type="text/x-red" data-template-name="schema-bridge">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Schema Bridge">
    </div>
    
    <div class="form-row">
        <ul style="min-width: 600px; margin-bottom: 20px;" id="node-schema-bridge-tabs"></ul>
    </div>
    
    <div id="node-schema-bridge-tabs-content" style="height: 500px; display: flex; flex-direction: column;">
        <!-- Basic Tab -->
        <div id="schema-bridge-tab-basic" style="display:none; flex: 1; overflow-y: auto; padding-right: 10px;">
            <!-- Operation Mode Selection -->
            <div class="form-row" style="background: linear-gradient(135deg, #2a2a2a 0%, #1e1e1e 100%); padding: 15px; border-radius: 8px; margin-bottom: 20px; border: 1px solid #555;">
                <label style="font-weight: bold; margin-bottom: 10px; display: block; color: #e0e0e0;"><i class="fa fa-toggle-on" style="color: #dc3545;"></i> Operation Mode</label>
                
                <div style="display: flex; gap: 15px;">
                    <label class="mode-option" style="flex: 1; cursor: pointer; padding: 12px; border: 2px solid #444; border-radius: 8px; text-align: center; transition: all 0.3s; background-color: #333;" id="connection-mode-label">
                        <input type="radio" name="operationMode" value="connection" id="node-input-operationMode-connection" style="display: none;">
                        <div>
                            <i class="fa fa-plug" style="font-size: 24px; color: #dc3545; margin-bottom: 8px; display: block;"></i>
                            <strong style="color: #e0e0e0;">üîó Database Connection Mode</strong>
                            <div style="font-size: 11px; color: #bbb; margin-top: 4px;">Connect to target database<br/>Generate SQL + Create Tables</div>
                        </div>
                    </label>
                    
                    <label class="mode-option" style="flex: 1; cursor: pointer; padding: 12px; border: 2px solid #444; border-radius: 8px; text-align: center; transition: all 0.3s; background-color: #333;" id="generation-mode-label">
                        <input type="radio" name="operationMode" value="generation" id="node-input-operationMode-generation" style="display: none;">
                        <div>
                            <i class="fa fa-file-code-o" style="font-size: 24px; color: #dc3545; margin-bottom: 8px; display: block;"></i>
                            <strong style="color: #e0e0e0;">üìù SQL Generation Mode</strong>
                            <div style="font-size: 11px; color: #bbb; margin-top: 4px;">Select database type only<br/>Generate SQL only (no connection)</div>
                        </div>
                    </label>
                </div>
            </div>
            
            <!-- Source Configuration -->
            <div class="form-row">
                <label for="node-input-sourceConnection"><i class="fa fa-database"></i> Source</label>
                <input type="text" id="node-input-sourceConnection">
            </div>
            
            <div class="form-row">
                <label for="node-input-sourceTable"><i class="fa fa-table"></i> Source Table</label>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <input type="text" id="node-input-sourceTable" placeholder="Enter table name..." style="flex: 1;">
                    <button type="button" id="load-schema-btn" class="red-ui-button" style="width: 120px; background-color: #4285F4; border-color: #3367D6; color: white; font-weight: bold;">
                        <i class="fa fa-refresh"></i> Load Schema
                    </button>
                </div>
            </div>
            
            <!-- Target Configuration -->
            <div id="target-connection-section" class="form-row">
                <label for="node-input-targetConnection"><i class="fa fa-database"></i> Target</label>
                <input type="text" id="node-input-targetConnection">
            </div>
            
            <div id="target-dbtype-section" class="form-row" style="display: none;">
                <label for="node-input-targetDbType"><i class="fa fa-server"></i> Target</label>
                <select id="node-input-targetDbType">
                    <option value="postgres">PostgreSQL</option>
                    <option value="mssql">Microsoft SQL Server</option>
                    <option value="mysql">MySQL</option>
                    <option value="oracle">Oracle Database</option>
                    <option value="informix">IBM Informix</option>
                </select>
            </div>
            
            <div class="form-row">
                <label for="node-input-targetTable"><i class="fa fa-table"></i> Target Table</label>
                <input type="text" id="node-input-targetTable" placeholder="Leave empty to use source table name">
            </div>
            
            <div class="form-row" style="border-top: 1px solid #ddd; padding-top: 15px; margin-top: 20px;">
                <label style="font-weight: bold;"><i class="fa fa-cogs"></i> Actions</label>
            </div>
            
            <div class="form-row">
                <input type="checkbox" id="node-input-generateSql" style="display: inline-block; width: auto; vertical-align: top;" checked>
                <label for="node-input-generateSql" style="width: auto; font-weight: normal;">
                    <i class="fa fa-code"></i> Generate SQL Commands
                    <span style="color: #666; font-size: 12px; display: block; margin-left: 20px;">Áî¢Áîü CREATE TABLE SQL Êåá‰ª§</span>
                </label>
            </div>
            
            <div class="form-row" id="create-table-option">
                <input type="checkbox" id="node-input-createTable" style="display: inline-block; width: auto; vertical-align: top;">
                <label for="node-input-createTable" style="width: auto; font-weight: normal;">
                    <i class="fa fa-table"></i> Create Table
                    <span style="color: #666; font-size: 12px; display: block; margin-left: 20px;">Âü∑Ë°å SQL Êåá‰ª§Âú®ÁõÆÊ®ôË≥áÊñôÂ∫´Âª∫Á´ãË°®Ê†º</span>
                </label>
            </div>
            
            <div id="mode-info" style="background-color: #2a2a2a; border: 1px solid #555; padding: 10px; border-radius: 4px; margin-top: 10px; font-size: 12px; color: #bbb;">
                <i class="fa fa-info-circle" style="color: #dc3545;"></i> 
                <span id="mode-info-text">ÊÇ®ÂèØ‰ª•ÂêåÊôÇÈÅ∏ÊìáÂÖ©ÂÄãÈÅ∏È†ÖÔºöÁî¢Áîü SQL ‰∏¶Âü∑Ë°åÂª∫Ë°®</span>
            </div>
        </div>
        
        <!-- Schema Editor Tab -->
        <div id="schema-bridge-tab-schema" style="display:none; flex: 1; display: flex; flex-direction: column;">
            <div style="flex-shrink: 0; margin-bottom: 15px;">
                <h4>Schema Editor</h4>
                <p>Modify the schema structure, column names, and data types before migration.</p>
            </div>
            
            <div id="schema-editor-container" style="flex: 1; display: flex; flex-direction: column;">
                <p>Please select a source connection and table in the Basic tab to load the schema.</p>
            </div>
        </div>
        
        <!-- SQL Output Tab -->
        <div id="schema-bridge-tab-sql" style="display:none; flex: 1; display: flex; flex-direction: column;">
            <div style="flex-shrink: 0; margin-bottom: 15px;">
                <h4>Generated SQL</h4>
                <p>Preview the SQL commands that will be generated based on your schema configuration.</p>
            </div>
            
            <div style="flex: 1; display: flex; flex-direction: column; gap: 15px;">
                <textarea id="sql-output" style="flex: 1; width: 100%; font-family: monospace; border: 1px solid #555; background-color: #2a2a2a; color: #e0e0e0; padding: 10px;" readonly placeholder="SQL commands will appear here..."></textarea>
                
                <div style="flex-shrink: 0;">
                    <button type="button" onclick="navigator.clipboard.writeText(document.getElementById('sql-output').value)" style="background-color: #4285F4; border-color: #3367D6; color: white; padding: 8px 16px; border-radius: 4px; cursor: pointer;">
                        <i class="fa fa-copy"></i> Copy SQL
                    </button>
                </div>
            </div>
        </div>
    </div>
</script>

<script type="text/html" data-help-name="schema-bridge">
    <p>The <b>Schema Bridge</b> node enables database schema migration between different database systems with two operation modes.</p>
    
    <h3>üîÄ Operation Modes</h3>
    <ul>
        <li><b>üîó Database Connection Mode</b> - Connect to target database, generate SQL + create tables</li>
        <li><b>üìù SQL Generation Mode</b> - Select database type only, generate SQL without connection</li>
    </ul>

    <h3>‚ú® Core Functions</h3>
    <ul>
        <li><b>Generate SQL</b> - Áî¢Áîü CREATE TABLE SQL Êåá‰ª§</li>
        <li><b>Create Table</b> - Âü∑Ë°å SQL Êåá‰ª§Âú®ÁõÆÊ®ôË≥áÊñôÂ∫´Âª∫Á´ãË°®Ê†º (Connection Mode only)</li>
    </ul>

    <h3>üöÄ Features</h3>
    <ul>
        <li><b>Dual Operation Modes</b> - Choose between full connection or SQL-only mode</li>
        <li><b>Visual Schema Editor</b> - Modify column names, data types, and constraints</li>
        <li><b>Smart Type Mapping</b> - Automatic data type conversion between databases</li>
        <li><b>Real-time Connection Status</b> - Automatic connection health monitoring</li>
        <li><b>SQL Preview</b> - Preview generated SQL commands before execution</li>
    </ul>

    <h3>üéØ Supported Databases</h3>
    <p>Microsoft SQL Server, PostgreSQL, MySQL, Oracle Database, IBM Informix</p>

    <h3>‚öôÔ∏è Configuration</h3>
    
    <h4>Operation Mode Selection</h4>
    <ul>
        <li><b>Database Connection Mode</b> - Requires both source and target database connections</li>
        <li><b>SQL Generation Mode</b> - Requires only source connection + target database type selection</li>
    </ul>
    
    <h4>Basic Tab</h4>
    <ul>
        <li><b>Source</b> - ‰æÜÊ∫êË≥áÊñôÂ∫´ÈÄ£Êé• (required in both modes)</li>
        <li><b>Source Table</b> - ‰æÜÊ∫êË°®Ê†ºÂêçÁ®±</li>
        <li><b>Target</b> - ÁõÆÊ®ôË≥áÊñôÂ∫´ÈÄ£Êé• (Connection Mode) Êàñ ÁõÆÊ®ôË≥áÊñôÂ∫´È°ûÂûã (Generation Mode)</li>
        <li><b>Target Table</b> - ÁõÆÊ®ôË°®Ê†ºÂêçÁ®±ÔºàÂèØÁïôÁ©∫‰ΩøÁî®‰æÜÊ∫êË°®Ê†ºÂêçÔºâ</li>
        <li><b>Generate SQL</b> - Áî¢Áîü CREATE TABLE SQL Êåá‰ª§</li>
        <li><b>Create Table</b> - Âü∑Ë°å SQL Âú®ÁõÆÊ®ôË≥áÊñôÂ∫´Âª∫Á´ãË°®Ê†º (Connection Mode only)</li>
    </ul>
    
    <h4>Schema Editor Tab</h4>
    <ul>
        <li><b>Visual Editor</b> - Ë¶ñË¶∫Âåñ‰øÆÊîπ schema ÁµêÊßã</li>
        <li><b>Column Management</b> - Êñ∞Â¢û„ÄÅÂà™Èô§ÊàñÈáçÊñ∞ÂëΩÂêçÊ¨Ñ‰Ωç</li>
        <li><b>Type Mapping</b> - Ë™øÊï¥Ë≥áÊñôÂûãÊÖãËΩâÊèõ</li>
        <li><b>Constraints</b> - Ë®≠ÂÆö nullable ÂíåÈ†êË®≠ÂÄº</li>
    </ul>
    
    <h4>SQL Output Tab</h4>
    <ul>
        <li><b>Preview</b> - È†êË¶ΩÁî¢ÁîüÁöÑ SQL Êåá‰ª§</li>
        <li><b>Copy</b> - Ë§áË£Ω SQL Âà∞Ââ™Ë≤ºÊùø‰ª•‰æøÊâãÂãïÂü∑Ë°å</li>
    </ul>

    <h3>üì§ Outputs</h3>
    <p>Ê†πÊìöÈÅ∏ÊìáÁöÑÊ®°ÂºèÂíåÂãï‰ΩúÔºåÁØÄÈªûÊúÉËº∏Âá∫ schema Ë≥áË®ä„ÄÅSQL Êåá‰ª§Âíå/ÊàñË°®Ê†ºÂª∫Á´ãÁãÄÊÖã„ÄÇ</p>
    
    <h4>Connection Mode Output</h4>
    <p>Includes connection details, SQL commands, and execution results (if table creation is enabled).</p>
    
    <h4>Generation Mode Output</h4>
    <p>Includes target database type, SQL commands for the specified database type, no execution results.</p>
</script> 